<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of AFQ_set</title>
  <meta name="keywords" content="AFQ_set">
  <meta name="description" content="Set properties of afq object">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">functions</a> &gt; AFQ_set.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for functions&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>AFQ_set
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Set properties of afq object</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function afq = AFQ_set(afq,param,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Set properties of afq object

 afq = AFQ_set(afq, param, [vargrgin])

 The afq structure stores all the AFQ computations.  AFQ_set is the main
 function to add values, images, computations etc. to this structure.  As
 inputs AFQ_set takes in an afq structure, a parameter defined as a
 'string' which is to be set, and a number of aditional arguments and
 values that are specific to that parameter.  The arguments for each
 parameter are described below.  AFQ_set always returns the modified afq
 structure.  The structure can be queried and values can be accessed with
 AFQ_get.  The structure is created with AFQ_Create.

 See also: <a href="AFQ_get.html" class="code" title="function val = AFQ_get(afq, param, varargin)">AFQ_get</a> <a href="AFQ_Create.html" class="code" title="function afq = AFQ_Create(varargin)">AFQ_Create</a>

 Parameter list and associated arguments:

  param           - varargin

 'images'         - Add images to compute tract profiles on.
                    varargin = 1xN cell array (N is number of subjects) of
                    paths to nifti images.
 'vals'           - Add Tract Profile values to afq structure.
                    varargin = 'subnum', subnum, 'valname', vals
 'norms'          - Compute and assign control group norms to afq.norms
                    varargin = no argument needed
 'sub_group'      - Define subject group (patient=1 control=0) to afq
                    structure.
                    varargin = [1 1 1 0 0 0.....,]
 'current subject'- Define current subject for afq computations
                    varargin = [subject number]
 'overwritefibers'- Recompute fibers for a subject. If the second argument
                    is blank then it will recompute for all subjects
                    varargin = [subject number]
 'overwritevals'  - Recompute Tract Profile values for a subject
                    varargin = [subject number]
 'wholebrain fg path'- Set the path to the wholebrain fiber group for a
                       subject
                       varargin = 'subnum', [subject number]
 'segmented fg path' - Set the path to the segmented fiber group for a
                       subject
                       varargin = 'subnum', [subject number]
 'clean fg path'     - Set the path to the cleaned fiber group for a
                       subject
                       varargin = 'subnum', [subject number]
 'tractprofiles'  - Add tract profiles to the afq structure for a subject.
                    This should be a structure with each of the AFQ fiber
                    groups in it.  See <a href="AFQ_CreateTractProfile.html" class="code" title="function TractProfile = AFQ_CreateTractProfile(varargin)">AFQ_CreateTractProfile</a>
                    varargin = 'subnum', [subject number], TractProfiles

 Example:

 afq = AFQ_set(afq, 'segemented fg path','subnum',10,'/data/sub10/fibers/'Morigroups.mat')

 Written by Jason D. Yeatman August 2012</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="AFQ_ComputeNorms.html" class="code" title="function [norms patient_data control_data afq] = AFQ_ComputeNorms(varargin)">AFQ_ComputeNorms</a>	Compute tract diffusion profile norms from control group data</li><li><a href="AFQ_run.html" class="code" title="function [afq patient_data control_data norms abn abnTracts] = AFQ_run(sub_dirs, sub_group, afq)">AFQ_run</a>	Run AFQ analysis on a set of subjects to generate Tract Profiles of white</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [subnum varargin]=GetSubNum(afq,varargin)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function afq = AFQ_set(afq,param,varargin)</a>
0002 <span class="comment">% Set properties of afq object</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% afq = AFQ_set(afq, param, [vargrgin])</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% The afq structure stores all the AFQ computations.  AFQ_set is the main</span>
0007 <span class="comment">% function to add values, images, computations etc. to this structure.  As</span>
0008 <span class="comment">% inputs AFQ_set takes in an afq structure, a parameter defined as a</span>
0009 <span class="comment">% 'string' which is to be set, and a number of aditional arguments and</span>
0010 <span class="comment">% values that are specific to that parameter.  The arguments for each</span>
0011 <span class="comment">% parameter are described below.  AFQ_set always returns the modified afq</span>
0012 <span class="comment">% structure.  The structure can be queried and values can be accessed with</span>
0013 <span class="comment">% AFQ_get.  The structure is created with AFQ_Create.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% See also: AFQ_get AFQ_Create</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Parameter list and associated arguments:</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%  param           - varargin</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% 'images'         - Add images to compute tract profiles on.</span>
0022 <span class="comment">%                    varargin = 1xN cell array (N is number of subjects) of</span>
0023 <span class="comment">%                    paths to nifti images.</span>
0024 <span class="comment">% 'vals'           - Add Tract Profile values to afq structure.</span>
0025 <span class="comment">%                    varargin = 'subnum', subnum, 'valname', vals</span>
0026 <span class="comment">% 'norms'          - Compute and assign control group norms to afq.norms</span>
0027 <span class="comment">%                    varargin = no argument needed</span>
0028 <span class="comment">% 'sub_group'      - Define subject group (patient=1 control=0) to afq</span>
0029 <span class="comment">%                    structure.</span>
0030 <span class="comment">%                    varargin = [1 1 1 0 0 0.....,]</span>
0031 <span class="comment">% 'current subject'- Define current subject for afq computations</span>
0032 <span class="comment">%                    varargin = [subject number]</span>
0033 <span class="comment">% 'overwritefibers'- Recompute fibers for a subject. If the second argument</span>
0034 <span class="comment">%                    is blank then it will recompute for all subjects</span>
0035 <span class="comment">%                    varargin = [subject number]</span>
0036 <span class="comment">% 'overwritevals'  - Recompute Tract Profile values for a subject</span>
0037 <span class="comment">%                    varargin = [subject number]</span>
0038 <span class="comment">% 'wholebrain fg path'- Set the path to the wholebrain fiber group for a</span>
0039 <span class="comment">%                       subject</span>
0040 <span class="comment">%                       varargin = 'subnum', [subject number]</span>
0041 <span class="comment">% 'segmented fg path' - Set the path to the segmented fiber group for a</span>
0042 <span class="comment">%                       subject</span>
0043 <span class="comment">%                       varargin = 'subnum', [subject number]</span>
0044 <span class="comment">% 'clean fg path'     - Set the path to the cleaned fiber group for a</span>
0045 <span class="comment">%                       subject</span>
0046 <span class="comment">%                       varargin = 'subnum', [subject number]</span>
0047 <span class="comment">% 'tractprofiles'  - Add tract profiles to the afq structure for a subject.</span>
0048 <span class="comment">%                    This should be a structure with each of the AFQ fiber</span>
0049 <span class="comment">%                    groups in it.  See AFQ_CreateTractProfile</span>
0050 <span class="comment">%                    varargin = 'subnum', [subject number], TractProfiles</span>
0051 <span class="comment">%</span>
0052 <span class="comment">% Example:</span>
0053 <span class="comment">%</span>
0054 <span class="comment">% afq = AFQ_set(afq, 'segemented fg path','subnum',10,'/data/sub10/fibers/'Morigroups.mat')</span>
0055 <span class="comment">%</span>
0056 <span class="comment">% Written by Jason D. Yeatman August 2012</span>
0057 
0058 <span class="comment">% remove spaces and upper case</span>
0059 param = mrvParamFormat(param);
0060 
0061 <span class="keyword">switch</span>(param)
0062     
0063     <span class="keyword">case</span> <span class="string">'images'</span> <span class="comment">% Add images to afq.files.images</span>
0064         afq.files.images(end+1).path = varargin{1};
0065         <span class="keyword">if</span> length(varargin) &gt; 1
0066             afq.files.images(end).name = varargin{2};
0067         <span class="keyword">else</span>
0068             s = strfind(varargin{1}{1},<span class="string">'/'</span>);
0069             p = strfind(varargin{1}{1},<span class="string">'.'</span>);
0070             p = p(p &gt; s(end));
0071             name = varargin{1}{1}(s(end)+1:p(1)-1);
0072             afq.files.images(end).name = name;
0073         <span class="keyword">end</span>
0074         
0075     <span class="keyword">case</span> <span class="string">'vals'</span> <span class="comment">% Add values to the afq.values field</span>
0076         <span class="keyword">if</span> length(varargin) &gt;= 4
0077             <span class="comment">% Add the values to the correct row of the data matrix</span>
0078             <span class="keyword">if</span> strcmp(<span class="string">'subnum'</span>,varargin{1})
0079                 <span class="comment">% If the subject number was defined use that row</span>
0080                 subnum = varargin{2};
0081                 <span class="comment">% The first value will be in varargin{3}</span>
0082                 val1 = 3;
0083             <span class="keyword">else</span>
0084                 <span class="comment">% Otherwise add to the row of the current subject that is</span>
0085                 <span class="comment">% being processed</span>
0086                 subnum = afq.currentsub;
0087                 <span class="comment">% The first value will be in varargin{1}</span>
0088                 val1 = 1;
0089             <span class="keyword">end</span>
0090             <span class="comment">% Loop over the values that were input</span>
0091             <span class="keyword">for</span> ii = val1:2:length(varargin)
0092                 <span class="comment">% Loop over the fiber tracts</span>
0093                 <span class="keyword">for</span> jj = 1:20
0094                     <span class="comment">% Take the stats that were calculated in</span>
0095                     <span class="comment">% AFQ_ComputeTractProperties and add them to a sructure</span>
0096                     <span class="comment">% for the full sample of subjects.  Each fiber group</span>
0097                     <span class="comment">% has its own cell. Within each cell there is a row for</span>
0098                     <span class="comment">% each subject with numberofnodes columns</span>
0099                     afq.vals.(varargin{ii}){jj}(subnum,:) = varargin{ii + 1}(:, jj);
0100                 <span class="keyword">end</span>
0101             <span class="keyword">end</span>
0102         <span class="keyword">end</span>
0103         
0104     <span class="keyword">case</span> <span class="string">'norms'</span> <span class="comment">% Compute and assign control group norms to afq.norms</span>
0105         valnames = fieldnames(afq.vals);
0106         <span class="keyword">for</span> ii = 1:length(valnames)
0107             <span class="keyword">for</span> jj = 1:length(afq.fgnames)
0108                 afq.norms.([<span class="string">'mean'</span> upper(valnames{ii})])(:,jj)  = nanmean(afq.vals.(valnames{ii}){jj}(afq.sub_group==0,:));
0109                 afq.norms.([<span class="string">'sd'</span> upper(valnames{ii})])(:,jj)  = nanstd(afq.vals.(valnames{ii}){jj}(afq.sub_group==0,:));
0110                 afq.patient_data(jj).([upper(valnames{ii})]) = afq.vals.(valnames{ii}){jj}(afq.sub_group==1,:);
0111                 afq.control_data(jj).([upper(valnames{ii})]) = afq.vals.(valnames{ii}){jj}(afq.sub_group==0,:);
0112             <span class="keyword">end</span>
0113         <span class="keyword">end</span>
0114         
0115     <span class="keyword">case</span> <span class="string">'sub_group'</span> <span class="comment">% Define subject groups in afq.sub_group</span>
0116         afq.sub_group = varargin{1};
0117     <span class="keyword">case</span> <span class="string">'sub_dirs'</span>
0118         afq.sub_dirs = varargin{1};
0119         
0120     <span class="keyword">case</span> <span class="string">'currentsubject'</span> <span class="comment">% Define the current subject being analyzed</span>
0121         afq.currentsub = varargin{1};
0122         
0123     <span class="keyword">case</span> <span class="string">'overwritefibers'</span> <span class="comment">% Recompute fiber groups for subject # varargin</span>
0124         <span class="comment">% If a subject number is defined only overwrite for that subject</span>
0125         <span class="keyword">if</span> nargin == 3
0126             afq.overwrite.fibers.wholebrain(varargin{1}) = 1;
0127             afq.overwrite.fibers.segmented(varargin{1})  = 1;
0128             afq.overwrite.fibers.clean(varargin{1})      = 1;
0129         <span class="keyword">else</span>
0130             <span class="comment">% Otherwise overwrite for all subjects</span>
0131             afq.overwrite.fibers.wholebrain(:)= 1;
0132             afq.overwrite.fibers.segmented(:)= 1;
0133             afq.overwrite.fibers.clean(:)= 1;
0134         <span class="keyword">end</span>
0135         
0136     <span class="keyword">case</span> <span class="string">'overwritevals'</span> <span class="comment">% Recompute values for subject # varargin</span>
0137         afq.overwrite.vals(varargin{1}) = 1;
0138         
0139     <span class="keyword">case</span> {<span class="string">'wholebrainfgpath'</span> <span class="string">'wholebrainpath'</span> <span class="string">'wholebrainfg'</span> <span class="string">'wholebrainfibergroup'</span>}
0140         <span class="comment">% Add the values to the correct row of the data matrix</span>
0141         <span class="keyword">if</span> strcmp(<span class="string">'subnum'</span>,varargin{1})
0142             <span class="comment">% If the subject number was defined use that row</span>
0143             subnum = varargin{2};
0144             <span class="comment">% The first value will be in varargin{3}</span>
0145             val1 = 3;
0146         <span class="keyword">else</span>
0147             <span class="comment">% Otherwise add to the row of the current subject that is</span>
0148             <span class="comment">% being processed</span>
0149             subnum = afq.currentsub;
0150             <span class="comment">% The first value will be in varargin{1}</span>
0151             val1 = 1;
0152         <span class="keyword">end</span>
0153         afq.files.fibers.wholebrain{subnum} = varargin{val1};
0154     <span class="keyword">case</span> {<span class="string">'segmentedfgpath'</span> <span class="string">'segmentedpath'</span> <span class="string">'segmentedfg'</span> <span class="string">'segmentedfibergroup'</span>}
0155         <span class="comment">% Add the values to the correct row of the data matrix</span>
0156         <span class="keyword">if</span> strcmp(<span class="string">'subnum'</span>,varargin{1})
0157             <span class="comment">% If the subject number was defined use that row</span>
0158             subnum = varargin{2};
0159             <span class="comment">% The first value will be in varargin{3}</span>
0160             val1 = 3;
0161         <span class="keyword">else</span>
0162             <span class="comment">% Otherwise add to the row of the current subject that is</span>
0163             <span class="comment">% being processed</span>
0164             subnum = afq.currentsub;
0165             <span class="comment">% The first value will be in varargin{1}</span>
0166             val1 = 1;
0167         <span class="keyword">end</span>
0168         afq.files.fibers.segmented{subnum} = varargin{val1};
0169     <span class="keyword">case</span> {<span class="string">'cleanfgpath'</span> <span class="string">'cleanpath'</span> <span class="string">'cleanfg'</span> <span class="string">'cleanfibergroup'</span>}
0170         <span class="comment">% Add the values to the correct row of the data matrix</span>
0171         <span class="keyword">if</span> strcmp(<span class="string">'subnum'</span>,varargin{1})
0172             <span class="comment">% If the subject number was defined use that row</span>
0173             subnum = varargin{2};
0174             <span class="comment">% The first value will be in varargin{3}</span>
0175             val1 = 3;
0176         <span class="keyword">else</span>
0177             <span class="comment">% Otherwise add to the row of the current subject that is</span>
0178             <span class="comment">% being processed</span>
0179             subnum = afq.currentsub;
0180             <span class="comment">% The first value will be in varargin{1}</span>
0181             val1 = 1;
0182         <span class="keyword">end</span>
0183         afq.files.fibers.clean{subnum} = varargin{val1};
0184     <span class="keyword">case</span>{<span class="string">'tractprofiles'</span> <span class="string">'tractprofile'</span>}
0185         <span class="comment">% Add the values to the correct row of the data matrix</span>
0186         <span class="keyword">if</span> strcmp(<span class="string">'subnum'</span>,varargin{1})
0187             <span class="comment">% If the subject number was defined use that row</span>
0188             subnum = varargin{2};
0189             <span class="comment">% The first value will be in varargin{3}</span>
0190             val1 = 3;
0191         <span class="keyword">else</span>
0192             <span class="comment">% Otherwise add to the row of the current subject that is</span>
0193             <span class="comment">% being processed</span>
0194             subnum = afq.currentsub;
0195             <span class="comment">% The first value will be in varargin{1}</span>
0196             val1 = 1;
0197         <span class="keyword">end</span>
0198         <span class="comment">% Loop over the number of tract profiles and assign them to the afq</span>
0199         <span class="comment">% structure</span>
0200         <span class="keyword">for</span> jj = 1:length(varargin{val1})
0201             afq.TractProfiles(subnum,jj) = varargin{val1}(jj);
0202         <span class="keyword">end</span>
0203     <span class="keyword">otherwise</span>
0204         error(<span class="string">'Uknown afq parameter'</span>);
0205 <span class="keyword">end</span>
0206 
0207 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0208 <a name="_sub1" href="#_subfunctions" class="code">function [subnum varargin]=GetSubNum(afq,varargin)</a>
0209 <span class="comment">% Check if subnum was input into AFQ_set</span>
0210 loc = strcmp(<span class="string">'subnum'</span>,varargin);
0211 <span class="keyword">if</span> sum(loc) == 1
0212     idx = find(loc);
0213     <span class="comment">% If so define the subjects number</span>
0214     subnum = varargin{idx+1};
0215     <span class="comment">% Then remove these cells from varargin</span>
0216     <span class="keyword">if</span> length(varargin) &gt;= idx+2
0217         varargin = varargin([1:idx-1, idx+2:end]);
0218     <span class="keyword">else</span>
0219         varargin = varargin(1:idx-1)
0220     <span class="keyword">end</span>
0221     <span class="comment">% Otherwise get the subject number from the afq structure</span>
0222 <span class="keyword">else</span>
0223     subnum = afq.currentsub;
0224 <span class="keyword">end</span>
0225 
0226 <span class="keyword">return</span>
0227</pre></div>
<hr><address>Generated on Wed 14-Nov-2012 17:12:08 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>