<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of AFQ_RenderCorticalSurface</title>
  <meta name="keywords" content="AFQ_RenderCorticalSurface">
  <meta name="description" content="Render the cortical surface from a binary segmentation image">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">3Dvis</a> &gt; AFQ_RenderCorticalSurface.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for 3Dvis&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>AFQ_RenderCorticalSurface
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Render the cortical surface from a binary segmentation image</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [p, msh] = AFQ_RenderCorticalSurface(cortex, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Render the cortical surface from a binary segmentation image

 [p, msh] = AFQ_RenderCorticalSurface(cortex, 'param', value ...)

 This function takes in a segmentation image and renders it in 3d. It is
 optimized to look good for the cortical surface but any image will work.
 The rendering will be added to the current figure window so you can add
 the cortex to a rendering of fiber groups and adjust it's transparency.
 The only input that is required is a segmentation image. There are also a
 number of parameters that can be set in the form of 'parameter', value,
 combinations. All the examples below will run if the AFQ mesh directory
 is your working directory: 
 [~, AFQdata] = AFQ_directories; cd(fullfile(AFQdata,'mesh'))

 Inputs:
 cortex  - A msh, mesh structure (see AFQ_meshCreate) or a path to a 
           nifti image to render. It must be a binary mask.
           AFQ_RenderCorticalSurface('segmentation.nii.gz');
 color   - RGB value for the surface of the rendering. Default is &quot;brain&quot;
           color. For example to render the cortex in orange:
           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'color', [1, 0.5, 0])
 alpha   - The transparency of the surface (alpha). 0 is completely
           transparent and 1 is completely opaque. For example to render
           the cortex half way transparent:
           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'alpha', 0.5)
 overlay - Another image to use to color the surface (for example an fMRI
           contrast or fiber endpoint image). For example to render the
           cortex with a heatmap of arcuate fasciculus endpoints:
           im = 'Left_Arcuate_Endpoints.nii.gz'
           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'overlay', im)
 thresh  - A threshold above/below which overlay values will be
           painted on the cortex and the cortex will be left cortex
           colored. Thresh can be a single number (minumum) or a vector of
           2 numbers (minimum and maximum).
           im = 'Left_Arcuate_Endpoints.nii.gz'
           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...
           'overlay', im, 'thresh', 0.01)
 crange  - Define which overlay values should be mapped to the minimum and
           maximum values of the color map. All values below crange(1)
           will be colored the minimum value and all values above
           crange(2) will be colored the maximum value. The default color
           range is defined by the minimum and maximum values of the
           overlay image that get mapped to any mesh vertex.
           im = 'Left_Arcuate_Endpoints.nii.gz'
           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...
           'overlay', im, 'thresh', 0.01, 'crange', [.02 .2])
 cmap    - Name of the colormap to use. For example 'jet' or 'autumn'
           im = 'Left_Arcuate_Endpoints.nii.gz'
           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...
           'overlay',im, 'thresh',0.01, 'crange',[.02 .2], 'cmap','hot')
 newfig  - Whether or not to open a new figure window
           AFQ_RenderCorticalSurface('segmentation.nii.gz','newfig',true);

 Outputs:
 p       - Handel for the patch object that was added to the figure
           window. The rendering can be deleted with delete(p)
 msh     - The mesh object of the cortical surface.

 Example:

 % Get data
 [~, AFQdata] = AFQ_directories; 
 cortex = fullfile(AFQdata,'mesh','segmentation.nii.gz');
 overlay = fullfile(AFQdata,'mesh','t1.nii.gz');
 % Render the cortical surface colored by the T1 values at each vertex
 p = AFQ_RenderCorticalSurface(cortex, 'overlay' , overlay)

 Copyright Jason D. Yeatman November 2012</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="AFQ_meshCreate.html" class="code" title="function msh = AFQ_meshCreate(im, varargin)">AFQ_meshCreate</a>	Create a mesh structure and build a 3d mesh from a nifti image</li><li><a href="AFQ_meshGet.html" class="code" title="function val = AFQ_meshGet(msh, param, varargin)">AFQ_meshGet</a>	Get parameters from an AFQ msh, mesh structure</li><li><a href="../utilities/CreateParamsStruct.html" class="code" title="function params = CreateParamsStruct(c)">CreateParamsStruct</a>	Create a parameters structure from a cell array.</li><li><a href="../utilities/ismesh.html" class="code" title="function L = ismesh(s)">ismesh</a>	Check if a variable is an AFQ msh mesh structure</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="AFQ_RenderRoi.html" class="code" title="function h = AFQ_RenderRoi(roi, color, method, render, varargin)">AFQ_RenderRoi</a>	Render an ROI as a 3D surface</li><li><a href="../tutorials/CortexAndFibersMovie.html" class="code" title="">CortexAndFibersMovie</a>	% Rendering videos of the cortex and fiber tracts</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [p, msh] = AFQ_RenderCorticalSurface(cortex, varargin)</a>
0002 <span class="comment">% Render the cortical surface from a binary segmentation image</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% [p, msh] = AFQ_RenderCorticalSurface(cortex, 'param', value ...)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% This function takes in a segmentation image and renders it in 3d. It is</span>
0007 <span class="comment">% optimized to look good for the cortical surface but any image will work.</span>
0008 <span class="comment">% The rendering will be added to the current figure window so you can add</span>
0009 <span class="comment">% the cortex to a rendering of fiber groups and adjust it's transparency.</span>
0010 <span class="comment">% The only input that is required is a segmentation image. There are also a</span>
0011 <span class="comment">% number of parameters that can be set in the form of 'parameter', value,</span>
0012 <span class="comment">% combinations. All the examples below will run if the AFQ mesh directory</span>
0013 <span class="comment">% is your working directory:</span>
0014 <span class="comment">% [~, AFQdata] = AFQ_directories; cd(fullfile(AFQdata,'mesh'))</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Inputs:</span>
0017 <span class="comment">% cortex  - A msh, mesh structure (see AFQ_meshCreate) or a path to a</span>
0018 <span class="comment">%           nifti image to render. It must be a binary mask.</span>
0019 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz');</span>
0020 <span class="comment">% color   - RGB value for the surface of the rendering. Default is &quot;brain&quot;</span>
0021 <span class="comment">%           color. For example to render the cortex in orange:</span>
0022 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'color', [1, 0.5, 0])</span>
0023 <span class="comment">% alpha   - The transparency of the surface (alpha). 0 is completely</span>
0024 <span class="comment">%           transparent and 1 is completely opaque. For example to render</span>
0025 <span class="comment">%           the cortex half way transparent:</span>
0026 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'alpha', 0.5)</span>
0027 <span class="comment">% overlay - Another image to use to color the surface (for example an fMRI</span>
0028 <span class="comment">%           contrast or fiber endpoint image). For example to render the</span>
0029 <span class="comment">%           cortex with a heatmap of arcuate fasciculus endpoints:</span>
0030 <span class="comment">%           im = 'Left_Arcuate_Endpoints.nii.gz'</span>
0031 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', 'overlay', im)</span>
0032 <span class="comment">% thresh  - A threshold above/below which overlay values will be</span>
0033 <span class="comment">%           painted on the cortex and the cortex will be left cortex</span>
0034 <span class="comment">%           colored. Thresh can be a single number (minumum) or a vector of</span>
0035 <span class="comment">%           2 numbers (minimum and maximum).</span>
0036 <span class="comment">%           im = 'Left_Arcuate_Endpoints.nii.gz'</span>
0037 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...</span>
0038 <span class="comment">%           'overlay', im, 'thresh', 0.01)</span>
0039 <span class="comment">% crange  - Define which overlay values should be mapped to the minimum and</span>
0040 <span class="comment">%           maximum values of the color map. All values below crange(1)</span>
0041 <span class="comment">%           will be colored the minimum value and all values above</span>
0042 <span class="comment">%           crange(2) will be colored the maximum value. The default color</span>
0043 <span class="comment">%           range is defined by the minimum and maximum values of the</span>
0044 <span class="comment">%           overlay image that get mapped to any mesh vertex.</span>
0045 <span class="comment">%           im = 'Left_Arcuate_Endpoints.nii.gz'</span>
0046 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...</span>
0047 <span class="comment">%           'overlay', im, 'thresh', 0.01, 'crange', [.02 .2])</span>
0048 <span class="comment">% cmap    - Name of the colormap to use. For example 'jet' or 'autumn'</span>
0049 <span class="comment">%           im = 'Left_Arcuate_Endpoints.nii.gz'</span>
0050 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz', ...</span>
0051 <span class="comment">%           'overlay',im, 'thresh',0.01, 'crange',[.02 .2], 'cmap','hot')</span>
0052 <span class="comment">% newfig  - Whether or not to open a new figure window</span>
0053 <span class="comment">%           AFQ_RenderCorticalSurface('segmentation.nii.gz','newfig',true);</span>
0054 <span class="comment">%</span>
0055 <span class="comment">% Outputs:</span>
0056 <span class="comment">% p       - Handel for the patch object that was added to the figure</span>
0057 <span class="comment">%           window. The rendering can be deleted with delete(p)</span>
0058 <span class="comment">% msh     - The mesh object of the cortical surface.</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% Example:</span>
0061 <span class="comment">%</span>
0062 <span class="comment">% % Get data</span>
0063 <span class="comment">% [~, AFQdata] = AFQ_directories;</span>
0064 <span class="comment">% cortex = fullfile(AFQdata,'mesh','segmentation.nii.gz');</span>
0065 <span class="comment">% overlay = fullfile(AFQdata,'mesh','t1.nii.gz');</span>
0066 <span class="comment">% % Render the cortical surface colored by the T1 values at each vertex</span>
0067 <span class="comment">% p = AFQ_RenderCorticalSurface(cortex, 'overlay' , overlay)</span>
0068 <span class="comment">%</span>
0069 <span class="comment">% Copyright Jason D. Yeatman November 2012</span>
0070 
0071 <span class="comment">% Create a parameters structure from any parameters that were defined</span>
0072 params = <a href="../utilities/CreateParamsStruct.html" class="code" title="function params = CreateParamsStruct(c)">CreateParamsStruct</a>(varargin);
0073 
0074 <span class="keyword">if</span> ~isfield(params,<span class="string">'alpha'</span>)
0075     params.alpha = 1;
0076 <span class="keyword">end</span>
0077 
0078 <span class="keyword">if</span> ~isfield(params,<span class="string">'newfig'</span>)
0079     params.newfig = 1;
0080 <span class="keyword">end</span>
0081 <span class="comment">%% Build a mesh of the cortical surface</span>
0082 
0083 <span class="comment">% If a msh structure was sent in then get the triangles. If an image was</span>
0084 <span class="comment">% sent in then build a mesh with the defined parameters</span>
0085 <span class="keyword">if</span> <a href="../utilities/ismesh.html" class="code" title="function L = ismesh(s)">ismesh</a>(cortex)
0086     tr = <a href="AFQ_meshGet.html" class="code" title="function val = AFQ_meshGet(msh, param, varargin)">AFQ_meshGet</a>(cortex,<span class="string">'triangles'</span>);
0087 <span class="keyword">else</span>
0088     msh = <a href="AFQ_meshCreate.html" class="code" title="function msh = AFQ_meshCreate(im, varargin)">AFQ_meshCreate</a>(cortex, params);
0089     tr = <a href="AFQ_meshGet.html" class="code" title="function val = AFQ_meshGet(msh, param, varargin)">AFQ_meshGet</a>(msh, <span class="string">'triangles'</span>);
0090 <span class="keyword">end</span>
0091 
0092 <span class="comment">%% Render the cortical surface</span>
0093 <span class="keyword">if</span> params.newfig == 1
0094     figure;
0095 <span class="keyword">end</span>
0096 <span class="comment">% Use patch to render the mesh</span>
0097 p = patch(tr);
0098 <span class="comment">%p = patch(tr,'facecolor',color,'edgecolor','none');</span>
0099 
0100 <span class="comment">% Interpolate the coloring along the surface</span>
0101 shading(<span class="string">'interp'</span>); 
0102 <span class="comment">% Set the type of lighting</span>
0103 lighting(<span class="string">'gouraud'</span>);
0104 <span class="comment">% Set the alpha</span>
0105 alpha(p,params.alpha);
0106 <span class="comment">% Set axis size</span>
0107 axis(<span class="string">'image'</span>);axis(<span class="string">'vis3d'</span>);
0108 <span class="comment">% Set lighiting options of the cortex</span>
0109 set(p,<span class="string">'specularstrength'</span>,.5,<span class="string">'diffusestrength'</span>,.75);
0110 
0111 <span class="comment">% If it was a new figure window add a light to it</span>
0112 <span class="keyword">if</span> params.newfig == 1
0113     view([270 0])
0114     camlight(<span class="string">'right'</span>);
0115 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 05-Dec-2012 12:03:42 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>