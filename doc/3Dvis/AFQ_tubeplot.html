<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of AFQ_tubeplot</title>
  <meta name="keywords" content="AFQ_tubeplot">
  <meta name="description" content="AFQ_tubeplot - plots a tube r along the space curve x,y,z.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">3Dvis</a> &gt; AFQ_tubeplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for 3Dvis&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>AFQ_tubeplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>AFQ_tubeplot - plots a tube r along the space curve x,y,z.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [varargout] = AFQ_tubeplot(x,y,z,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> AFQ_tubeplot - plots a tube r along the space curve x,y,z.

 AFQ_tubeplot(x,y,z) plots the basic tube with radius 1
 AFQ_tubeplot(x,y,z,r) plots the basic tube with variable radius r (either
 a vector or a value) AFQ_tubeplot(x,y,z,r,v) plots the basic tube with
 coloring dependent on the values in the vector v
 AFQ_tubeplot(x,y,z,r,v,s) plots the tube with s tangential subdivisions
 (default is 6)

 [X,Y,Z]=AFQ_tubeplot(x,y,z) returns [Nx3] matrices suitable for mesh or
 surf

 Note that the tube may pinch at points where the normal and binormal
 misbehaves. It is suitable for general space curves, not ones that
 contain straight sections. Normally the tube is calculated using the
 Frenet frame, making the tube minimally twisted except at inflexion
 points.

 To deal with this problem there is an alternative frame:
 AFQ_tubeplot(x,y,z,r,v,s,vec) calculates the tube by setting the normal
 to the cross product of the tangent and the vector vec. If it is chosen
 so that it is always far from the tangent vector the frame will not twist
 unduly

 Example:

  t=0:(2*pi/100):(2*pi); x=cos(t*2).*(2+sin(t*3)*.3);
  y=sin(t*2).*(2+sin(t*3)*.3); z=cos(t*3)*.3;
  AFQ_tubeplot(x,y,z,0.14*sin(t*5)+.29,t,10)

 Derived from code by Anders Sandber, asa@nada.kth.se, 2005
 Modified by Jason D Yeatman, April 2012. 

 Copyright Vista Team 2012</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../utilities/frame.html" class="code" title="function [t,n,b]=frame(x,y,z,vec)">frame</a>	FRAME Calculate a Frenet-like frame for a polygonal space curve</li><li><a href="../utilities/frenet.html" class="code" title="function [t,n,b]=frenet(x,y,z)">frenet</a>	FRENET Calculate the Frenet frame for a polygonal space curve</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [varargout] = AFQ_tubeplot(x,y,z,varargin)</a>
0002 
0003 <span class="comment">% AFQ_tubeplot - plots a tube r along the space curve x,y,z.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% AFQ_tubeplot(x,y,z) plots the basic tube with radius 1</span>
0006 <span class="comment">% AFQ_tubeplot(x,y,z,r) plots the basic tube with variable radius r (either</span>
0007 <span class="comment">% a vector or a value) AFQ_tubeplot(x,y,z,r,v) plots the basic tube with</span>
0008 <span class="comment">% coloring dependent on the values in the vector v</span>
0009 <span class="comment">% AFQ_tubeplot(x,y,z,r,v,s) plots the tube with s tangential subdivisions</span>
0010 <span class="comment">% (default is 6)</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% [X,Y,Z]=AFQ_tubeplot(x,y,z) returns [Nx3] matrices suitable for mesh or</span>
0013 <span class="comment">% surf</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Note that the tube may pinch at points where the normal and binormal</span>
0016 <span class="comment">% misbehaves. It is suitable for general space curves, not ones that</span>
0017 <span class="comment">% contain straight sections. Normally the tube is calculated using the</span>
0018 <span class="comment">% Frenet frame, making the tube minimally twisted except at inflexion</span>
0019 <span class="comment">% points.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% To deal with this problem there is an alternative frame:</span>
0022 <span class="comment">% AFQ_tubeplot(x,y,z,r,v,s,vec) calculates the tube by setting the normal</span>
0023 <span class="comment">% to the cross product of the tangent and the vector vec. If it is chosen</span>
0024 <span class="comment">% so that it is always far from the tangent vector the frame will not twist</span>
0025 <span class="comment">% unduly</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% Example:</span>
0028 <span class="comment">%</span>
0029 <span class="comment">%  t=0:(2*pi/100):(2*pi); x=cos(t*2).*(2+sin(t*3)*.3);</span>
0030 <span class="comment">%  y=sin(t*2).*(2+sin(t*3)*.3); z=cos(t*3)*.3;</span>
0031 <span class="comment">%  AFQ_tubeplot(x,y,z,0.14*sin(t*5)+.29,t,10)</span>
0032 <span class="comment">%</span>
0033 <span class="comment">% Derived from code by Anders Sandber, asa@nada.kth.se, 2005</span>
0034 <span class="comment">% Modified by Jason D Yeatman, April 2012.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% Copyright Vista Team 2012</span>
0037 
0038 <span class="comment">%% Argument checking</span>
0039 subdivs = 6;
0040 crange = [.35 .6]; <span class="comment">%color range</span>
0041 cmap = <span class="string">'jet'</span>
0042 N=size(x,1);
0043 <span class="keyword">if</span> (N==1)
0044     x=x';
0045     y=y';
0046     z=z';
0047     N=size(x,1);
0048 <span class="keyword">end</span>
0049 
0050 <span class="keyword">if</span> (nargin == 3)
0051     r=x*0+1;
0052 <span class="keyword">else</span>
0053     r=varargin{1};
0054     <span class="keyword">if</span> (size(r,1)==1 &amp; size(r,2)==1)
0055         r=r*ones(N,1);
0056     <span class="keyword">end</span>
0057 <span class="keyword">end</span>
0058 <span class="keyword">if</span> (nargin &gt; 5)
0059     subdivs=varargin{3}+1;
0060 <span class="keyword">end</span>
0061 <span class="keyword">if</span> (nargin &gt; 6)
0062     vec=varargin{4};
0063     [t,n,b]=<a href="../utilities/frame.html" class="code" title="function [t,n,b]=frame(x,y,z,vec)">frame</a>(x,y,z,vec);
0064 <span class="keyword">else</span>
0065     [t,n,b]=<a href="../utilities/frenet.html" class="code" title="function [t,n,b]=frenet(x,y,z)">frenet</a>(x,y,z);
0066 <span class="keyword">end</span>
0067 
0068 <span class="comment">%% Plotting</span>
0069 X=zeros(N,subdivs);
0070 Y=zeros(N,subdivs);
0071 Z=zeros(N,subdivs);
0072 
0073 theta=0:(2*pi/(subdivs-1)):(2*pi);
0074 
0075 <span class="keyword">for</span> i=1:N
0076     X(i,:)=x(i) + r(i)*(n(i,1)*cos(theta) + b(i,1)*sin(theta));
0077     Y(i,:)=y(i) + r(i)*(n(i,2)*cos(theta) + b(i,2)*sin(theta));
0078     Z(i,:)=z(i) + r(i)*(n(i,3)*cos(theta) + b(i,3)*sin(theta));
0079 <span class="keyword">end</span>
0080 
0081 <span class="keyword">if</span> (nargout==0)
0082     <span class="keyword">if</span> (nargin &gt; 4)
0083         V=varargin{2};
0084         <span class="keyword">if</span> (size(V,1)==1)
0085             V=V';
0086         <span class="keyword">end</span>
0087         V=V*ones(1,subdivs);
0088         surf(X,Y,Z,V);
0089     <span class="keyword">else</span>
0090         surf(X,Y,Z);
0091     <span class="keyword">end</span>
0092 <span class="keyword">else</span>
0093     varargout(1) = {X};
0094     varargout(2) = {Y};
0095     varargout(3) = {Z};
0096 <span class="keyword">end</span>
0097 
0098 <span class="comment">%% Setting the lighting etc.</span>
0099 shading(<span class="string">'interp'</span>);
0100 lighting(<span class="string">'gouraud'</span>);
0101 camlight(<span class="string">'headlight'</span>);
0102 axis(<span class="string">'equal'</span>);
0103 axis([min(x)-r(1) max(x)+r(1) min(y)-r(1) max(y)+r(1) min(z)-r(1) max(z)+r(1) crange(1) crange(2)])
0104 colormap(cmap);
0105 set(gca,<span class="string">'cameraposition'</span>,[min(x)-r(1) 0 0],<span class="string">'cameratarget'</span>,[0 0 0]);
0106 xlabel(<span class="string">'X mm'</span>); ylabel(<span class="string">'Y mm'</span>); zlabel(<span class="string">'Z mm'</span>)
0107 camlight(<span class="string">'headlight'</span>);</pre></div>
<hr><address>Generated on Wed 05-Dec-2012 12:03:42 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>