<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of refinepatch</title>
  <meta name="keywords" content="refinepatch">
  <meta name="description" content="This function &quot;refinepatch&quot; refines a triangular mesh with">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">3Dvis</a> &gt; <a href="index.html">refinepatch_version2b</a> &gt; refinepatch.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for 3Dvis/refinepatch_version2b&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>refinepatch
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This function &quot;refinepatch&quot; refines a triangular mesh with</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [FV2]=refinepatch(FV) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> This function &quot;refinepatch&quot; refines a triangular mesh with 
 a spline interpolated 4-split method.

   [FV2] = refinepatch(FV,options)

 inputs,
   FV : Structure containing a Patch, with
        FV.vertices the mesh vertices
        FV.face the mesh faces (triangles), rows with each 3 vertex indices
 outputs,
   FV2 : Structure Containing the refined patch


 Reference:
  The spline interpolation of the face edges is done by the 
  Opposite Edge Method, described in: &quot;Construction of Smooth Curves 
  and Surfaces from Polyhedral Models&quot; by Leon A. Shirman 

 How it works:
  The tangents (normals) and velocity on the edge points of all edges 
  are calculated. Which are  later used for b-spline interpolation when 
  splitting the edges.

  A tangent on an 3D line or edge is under defined and can rotate along 
  the line, thus an (virtual) opposite vertex is used to fix the tangent and
  make it more like a surface normal.

  B-spline interpolate a half way vertices between all existing vertices
  using the velocity and tangent from the edgepoints. After splitting a
  new facelist is constructed

 Speed:
  Compile the c-functions for more speed with:
   mex vertex_neighbours_double.c -v;
   mex edge_tangents_double.c -v;

 Example:

 X=[-0.5000;  0.5000;  0.0000;  0.0000];
 Y=[-0.2887; -0.2887;  0.5774;  0.0000];
 Z=[ 0.0000;  0.0000;  0.0000;  0.8165];
 FV.vertices=[X Y Z];

 FV.faces=[2 3 4; 4 3 1; 1 2 4; 3 2 1];

 figure, set(gcf, 'Renderer', 'opengl'); axis equal;
 for i=1:4
   patch(FV,'facecolor',[1 0 0]);
   pause(2);
   [FV]=refinepatch(FV);
 end

 Function is written by D.Kroon University of Twente (February 2010)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="edge_tangents.html" class="code" title="function [ET_table,EV_table,ETV_index]=edge_tangents(V,Ne)">edge_tangents</a>	</li><li><a href="make_halfway_vertices.html" class="code" title="function [Vout,HT_index, HT_values]=make_halfway_vertices(EV_table,ET_table,ETV_index,V,Ne)">make_halfway_vertices</a>	ETV_index_sparse=sparse(size(V,1),size(V,1));</li><li><a href="makenewfacelist.html" class="code" title="function Fnew=makenewfacelist(F,HT_index, HT_values)">makenewfacelist</a>	Combine the edge middle points and old vertex points to faces.</li><li><a href="vertex_neighbours.html" class="code" title="function Ne=vertex_neighbours(FV)">vertex_neighbours</a>	This function VERTEX_NEIGHBOURS will search in a face list for all</li><li><a href="../../3Dvis/smoothpatch_version1b/vertex_neighbours.html" class="code" title="function Ne=vertex_neighbours(FV)">vertex_neighbours</a>	This function VERTEX_NEIGHBOURS will search in a face list for all</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [FV2]=refinepatch(FV)</a>
0002 <span class="comment">% This function &quot;refinepatch&quot; refines a triangular mesh with</span>
0003 <span class="comment">% a spline interpolated 4-split method.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   [FV2] = refinepatch(FV,options)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% inputs,</span>
0008 <span class="comment">%   FV : Structure containing a Patch, with</span>
0009 <span class="comment">%        FV.vertices the mesh vertices</span>
0010 <span class="comment">%        FV.face the mesh faces (triangles), rows with each 3 vertex indices</span>
0011 <span class="comment">% outputs,</span>
0012 <span class="comment">%   FV2 : Structure Containing the refined patch</span>
0013 <span class="comment">%</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Reference:</span>
0016 <span class="comment">%  The spline interpolation of the face edges is done by the</span>
0017 <span class="comment">%  Opposite Edge Method, described in: &quot;Construction of Smooth Curves</span>
0018 <span class="comment">%  and Surfaces from Polyhedral Models&quot; by Leon A. Shirman</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% How it works:</span>
0021 <span class="comment">%  The tangents (normals) and velocity on the edge points of all edges</span>
0022 <span class="comment">%  are calculated. Which are  later used for b-spline interpolation when</span>
0023 <span class="comment">%  splitting the edges.</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%  A tangent on an 3D line or edge is under defined and can rotate along</span>
0026 <span class="comment">%  the line, thus an (virtual) opposite vertex is used to fix the tangent and</span>
0027 <span class="comment">%  make it more like a surface normal.</span>
0028 <span class="comment">%</span>
0029 <span class="comment">%  B-spline interpolate a half way vertices between all existing vertices</span>
0030 <span class="comment">%  using the velocity and tangent from the edgepoints. After splitting a</span>
0031 <span class="comment">%  new facelist is constructed</span>
0032 <span class="comment">%</span>
0033 <span class="comment">% Speed:</span>
0034 <span class="comment">%  Compile the c-functions for more speed with:</span>
0035 <span class="comment">%   mex vertex_neighbours_double.c -v;</span>
0036 <span class="comment">%   mex edge_tangents_double.c -v;</span>
0037 <span class="comment">%</span>
0038 <span class="comment">% Example:</span>
0039 <span class="comment">%</span>
0040 <span class="comment">% X=[-0.5000;  0.5000;  0.0000;  0.0000];</span>
0041 <span class="comment">% Y=[-0.2887; -0.2887;  0.5774;  0.0000];</span>
0042 <span class="comment">% Z=[ 0.0000;  0.0000;  0.0000;  0.8165];</span>
0043 <span class="comment">% FV.vertices=[X Y Z];</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% FV.faces=[2 3 4; 4 3 1; 1 2 4; 3 2 1];</span>
0046 <span class="comment">%</span>
0047 <span class="comment">% figure, set(gcf, 'Renderer', 'opengl'); axis equal;</span>
0048 <span class="comment">% for i=1:4</span>
0049 <span class="comment">%   patch(FV,'facecolor',[1 0 0]);</span>
0050 <span class="comment">%   pause(2);</span>
0051 <span class="comment">%   [FV]=refinepatch(FV);</span>
0052 <span class="comment">% end</span>
0053 <span class="comment">%</span>
0054 <span class="comment">% Function is written by D.Kroon University of Twente (February 2010)</span>
0055 
0056 <span class="comment">% Get the neighbour vertices of each vertice from the face list.</span>
0057 Ne=<a href="vertex_neighbours.html" class="code" title="function Ne=vertex_neighbours(FV)">vertex_neighbours</a>(FV);
0058 
0059 <span class="comment">% Calculate the tangents (normals) and velocity of all edges. Which is</span>
0060 <span class="comment">% later used for b-spline interpolation and split of the edges</span>
0061 <span class="comment">%</span>
0062 <span class="comment">% A tangent on an 3D line or edge is under defined and can rotate along</span>
0063 <span class="comment">% the line, thus an (virtual) opposite vertex is used to fix the tangent and</span>
0064 <span class="comment">% make it more like a surface normal.</span>
0065 V=FV.vertices; F=FV.faces;
0066 [ET_table,EV_table,ETV_index]=<a href="edge_tangents.html" class="code" title="function [ET_table,EV_table,ETV_index]=edge_tangents(V,Ne)">edge_tangents</a>(V,Ne);
0067 
0068 <span class="comment">% B-spline interpolate a half way vertices between all existing vertices</span>
0069 <span class="comment">% using the velocity and tangent from above</span>
0070 [V,HT_index, HT_values]=<a href="make_halfway_vertices.html" class="code" title="function [Vout,HT_index, HT_values]=make_halfway_vertices(EV_table,ET_table,ETV_index,V,Ne)">make_halfway_vertices</a>(EV_table,ET_table,ETV_index,V,Ne);
0071 
0072 <span class="comment">% Make new facelist</span>
0073 Fnew=<a href="makenewfacelist.html" class="code" title="function Fnew=makenewfacelist(F,HT_index, HT_values)">makenewfacelist</a>(F,HT_index,HT_values);
0074 
0075 FV2.vertices=V;
0076 FV2.faces=Fnew;
0077 
0078 
0079</pre></div>
<hr><address>Generated on Wed 05-Dec-2012 12:03:42 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>